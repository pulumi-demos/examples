graph TB
    subgraph AWS["AWS Account"]
        subgraph Region["US East 1 (N. Virginia)"]
            subgraph VPC["myVpc - CIDR: 10.0.0.0/16"]
                subgraph AZ1["us-east-1a"]
                    subgraph PublicSubnet["myPublicSubnet - CIDR: 10.0.1.0/24<br/>mapPublicIpOnLaunch: true"]
                        EC2["myInstance<br/>Type: t2.micro<br/>AMI: Latest Amazon Linux 2<br/>Public IP: Auto-assigned<br/>User Data: Creates index.html + starts Python server"]
                        
                        subgraph Storage["Block Storage"]
                            EBS["Root EBS Volume<br/>Type: gp2 (default)<br/>Size: 8GB<br/>Mount: / (root filesystem)<br/>Contains: OS + index.html"]
                        end
                    end
                end
                
                IGW["myInternetGateway<br/>Provides internet connectivity<br/>Attached to VPC"]
                
                RT["myRouteTable<br/>Default route: 0.0.0.0/0 → IGW<br/>Associated with myPublicSubnet<br/>Enables internet access"]
                
                SG["mySecurityGroup<br/>Attached to myInstance<br/>Ingress Rules:<br/>• HTTP (80/tcp) from allowed IP range<br/>• SSH (22/tcp) from allowed IP range<br/>Egress: All traffic allowed<br/>IP-based access control"]
                
                RTA["myRouteTableAssociation<br/>Links route table to subnet<br/>Enables routing rules"]
            end
        end
    end
    
    WEB_USER["Web Users<br/>HTTP Access (allowed IP range)<br/>Web Browsers"]
    ADMIN_USER["Admin Users<br/>SSH Access (allowed IP range)<br/>Terminal/SSH Clients"]
    BLOCKED["Blocked Traffic<br/>All Other IP Addresses<br/>Access Denied by Security Group"]
    
    %% Web Traffic Flow
    WEB_USER -->|HTTP GET Requests<br/>Port 80/TCP from allowed IP range| IGW
    
    %% Admin Traffic Flow  
    ADMIN_USER -->|SSH Connections<br/>Port 22/TCP from allowed IP range| IGW
    IGW -->|Ingress Traffic<br/>NAT & Routing| RT
    RT -->|Subnet Routing<br/>10.0.1.0/24| PublicSubnet
    PublicSubnet -->|Instance Access<br/>Security Group Filter| EC2
    EC2 -->|HTTP Responses<br/>Serves index.html| WEB_USER
    EC2 -->|SSH Shell Access<br/>Remote Administration| ADMIN_USER
    
    %% Blocked Traffic Flow
    BLOCKED -.->|Access Denied<br/>All other IPs blocked| SG
    SG -.->|Firewall Rules<br/>All other IPs blocked| BLOCKED
    
    %% Infrastructure Relationships  
    RT -.->|Association| RTA
    RTA -.->|Links to| PublicSubnet
    SG -->|Network Security<br/>Firewall Rules| EC2
    EC2 -->|Block Storage<br/>Root Volume| EBS
    
    %% User Data Process Flow
    EC2 -.->|Boot Script Execution| UserData["User Data Script<br/>1. echo 'Hello, World!' > index.html<br/>2. nohup python -m SimpleHTTPServer 80 &"]
    UserData -.->|Creates Content| EBS
    UserData -.->|Starts Web Server| PythonProcess["Python HTTP Server<br/>Process on port 80<br/>Serves files from /"]
    
    %% Styling
    classDef vpc fill:#e1f5fe,stroke:#0277bd,stroke-width:2px
    classDef subnet fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px
    classDef ec2 fill:#fff3e0,stroke:#f57c00,stroke-width:2px
    classDef network fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px
    classDef storage fill:#fce4ec,stroke:#c2185b,stroke-width:2px
    classDef internet fill:#e3f2fd,stroke:#1976d2,stroke-width:2px
    classDef process fill:#f1f8e9,stroke:#689f38,stroke-width:2px
    classDef blocked fill:#ffebee,stroke:#d32f2f,stroke-width:2px
    
    class VPC vpc
    class PublicSubnet subnet
    class EC2 ec2
    class EBS storage
    class IGW,RT,SG,RTA network
    class WEB_USER,ADMIN_USER internet
    class BLOCKED blocked
    class UserData,PythonProcess process